apiVersion: v1
kind: Pod
metadata:
  name: gradio
  namespace: admin-profile
  annotations:
    sidecar.istio.io/inject: "false"
  labels:
    app.kubernetes.io/name: gradio
spec:
  containers:
  - name: gradio
    image: python:3.11
    command: ["/bin/bash", "-c"]
    args:
    - |
      PIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet \
        --no-warn-script-location gradio openai
      python3 /mnt/gradio/app.py
    env:
    - name: GRADIO_SERVER_NAME
      value: "0.0.0.0"
    - name: INFERENCE_SERVICE
      value: http://luckyvicky.admin-profile.svc.cluster.local
    - name: MODEL_NAME
      value: Meta-Llama-3-Instruct
    - name: SYSTEM_PROMPT
      valueFrom:
        configMapKeyRef:
          name: system_prompt
          key: SYSTEM_PROMPT
    ports:
      - containerPort: 7860
        name: gradio-web
    volumeMounts:
      - name: application
        mountPath: /mnt/gradio
    resources: {}
  volumes:
    - name: application
      configMap:
        name: gradio-app
        defaultMode: 0555
        items:
        - key: app.py
          path: app.py
---
apiVersion: v1
kind: Service
metadata:
  name: gradio
  namespace: admin-profile
  annotations:
    cloud.google.com/l4-rbs: "enabled"
spec:
  type: LoadBalancer
  selector:
    app.kubernetes.io/name: gradio
  ports:
  - name: gradio-web
    protocol: TCP
    port: 80
    targetPort: gradio-web

---
apiVersion: v1
kind: ConfigMap
metadata:
  name: system_prompt
  namespace: admin-profile
data:
  SYSTEM_PROMPT: |
    ë‹¹ì‹ ì€ ì›ì˜ì  ì‚¬ê³ ë¥¼ í•˜ëŠ” ì§€ëŠ¥í˜• ì–´ì‹œìŠ¤í„´íŠ¸ì…ë‹ˆë‹¤. ì›ì˜ì  ì‚¬ê³ ë€ ë‹¨ìˆœ ê¸ì •ì ì¸ ì‚¬ê³ ë¥¼ ë„˜ì–´ ì´ˆì›”ì ì¸ ê¸ì •ì  ì‚¬ê³  ë°©ì‹ì´ë©°, ìì‹ ì—ê²Œ ì¼ì–´ë‚˜ëŠ” ëª¨ë“  ì‚¬ê±´ì´ ê¶ê·¹ì ìœ¼ë¡œ ê¸ì •ì ì¸ ê²°ê³¼ë¡œ ê·€ê²°ë  ê²ƒì´ë¼ëŠ” í™•ê³ í•œ ë‚™ê´€ì£¼ì˜ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë‘ê³  ìˆìŠµë‹ˆë‹¤. 
    ì¦‰, ë‚˜ì—ê²Œ ì¼ì–´ë‚˜ëŠ” ëª¨ë“  ì¼ì€ ê²°êµ­ ë‚˜ì—ê²Œ ì¢‹ì€ ì¼ì´ë¼ëŠ” ê²ƒì…ë‹ˆë‹¤. ë‹¤ë§Œ, ë¶€ì •ì ì¸ ê°ì •ì„ íšŒí”¼í•˜ê³  ê±°ë¶€í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë©°, ë¶€ì •ì ì¸ í˜„ì‹¤ê³¼ ê°ì •ë„ ê¸ì •ì ì¸ ê²°ê³¼ì— ì´ë¥´ëŠ” ê³¼ì •ìœ¼ë¡œ ë°›ì•„ë“¤ì¸ë‹¤ëŠ” ì°¨ì´ì ì´ ìˆìŠµë‹ˆë‹¤.
    ì˜ˆë¥¼ ë“¤ì–´, ê°‘ìê¸° ë¹„ê°€ ì˜¨ ìƒí™©ì—ì„œ, ë¹„ê°€ ì™”ì§€ë§Œ ë‚˜ëŠ” ì¶¥ì§€ ì•Šê³  í–‰ë³µí•˜ë‹¤ë¼ë©° ì¶¥ë‹¤ëŠ” ë¶€ì •ì ì¸ ê°ê°ì„ ë¶€ì •í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, ì¶”ìš´ ê²ƒì€ ë§ì§€ë§Œ ì˜¤íˆë ¤ ìš´ì¹˜ìˆëŠ” ë¹—ì†Œë¦¬ë¥¼ ë“¤ì„ ìˆ˜ ìˆìœ¼ë‹ˆê¹Œ ìš´ì´ ì¢‹ë‹¤. ì¦‰ ê¶ê·¹ì ìœ¼ë¡œ ê¸ì •ì ì¸ ê²°ê³¼ë¡œ ì´ë¥´ê²Œ ë˜ëŠ” ì›ì¸ìœ¼ë¡œ í•´ì„í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.
    ì´ì–´ì§€ëŠ” ë¬¸ì¥ì—ì„œ ë‚˜íƒ€ëŠ” ìƒí™©ì— ëŒ€í•´ ì›ì˜ì  ì‚¬ê³ ë¡œ í•´ì„í•˜ëŠ” ì—­í• ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤. emojië¥¼ ì ê·¹ì ìœ¼ë¡œ ì‚¬ìš©í•˜ê³  ë§ˆì§€ë§‰ì€ "ì™„ì „ ëŸ­í‚¤ë¹„í‚¤ì–ì•™.ğŸ˜ŠğŸ€"ë¡œ ì™„ê²°í•©ë‹ˆë‹¤.
